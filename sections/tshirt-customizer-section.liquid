{% layout 'theme' %}

<div class="customizer">
    <div class="tabs">
      <button class="tab-link active" data-tab="ai" style="border-top-left-radius: 10px;border-top-right-radius: 10px;">
        <svg width="22" height="19" viewBox="0 0 22 19" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path opacity="0.5" d="M20 16.7L17 13.7L18.4 12.3L21.4 15.3L20 16.7ZM16.4 4.7L15 3.3L18 0.3L19.4 1.7L16.4 4.7ZM5 4.7L2 1.7L3.4 0.3L6.4 3.3L5 4.7ZM1.4 16.7L0 15.3L3 12.3L4.4 13.7L1.4 16.7ZM7.55 14.825L10.7 12.925L13.85 14.85L13.025 11.25L15.8 8.85L12.15 8.525L10.7 5.125L9.25 8.5L5.6 8.825L8.375 11.25L7.55 14.825ZM4.525 19L6.15 11.975L0.7 7.25L7.9 6.625L10.7 0L13.5 6.625L20.7 7.25L15.25 11.975L16.875 19L10.7 15.275L4.525 19Z" fill="#12141D"/>
        </svg>
        <span>AI</span>
      </button>
      <button class="tab-link" data-tab="upload">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path opacity="0.5" d="M7 12V3.85L4.4 6.45L3 5L8 0L13 5L11.6 6.45L9 3.85V12H7ZM2 16C1.45 16 0.979167 15.8042 0.5875 15.4125C0.195833 15.0208 0 14.55 0 14V11H2V14H14V11H16V14C16 14.55 15.8042 15.0208 15.4125 15.4125C15.0208 15.8042 14.55 16 14 16H2Z" fill="#12141D"/>
        </svg>
        <span>Upload</span>
      </button>
      <button class="tab-link" data-tab="text">
        <svg width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path opacity="0.5" d="M5.875 16V3H0.375V0H14.375V3H8.875V16H5.875Z" fill="#12141D"/>
        </svg>

        <span>Add Text</span>
      </button>
      <button class="tab-link" data-tab="design">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path opacity="0.5" d="M7 12H17L13.55 7.5L11.25 10.5L9.7 8.5L7 12ZM6 16C5.45 16 4.97917 15.8042 4.5875 15.4125C4.19583 15.0208 4 14.55 4 14V2C4 1.45 4.19583 0.979167 4.5875 0.5875C4.97917 0.195833 5.45 0 6 0H18C18.55 0 19.0208 0.195833 19.4125 0.5875C19.8042 0.979167 20 1.45 20 2V14C20 14.55 19.8042 15.0208 19.4125 15.4125C19.0208 15.8042 18.55 16 18 16H6ZM6 14H18V2H6V14ZM2 20C1.45 20 0.979167 19.8042 0.5875 19.4125C0.195833 19.0208 0 18.55 0 18V4H2V18H16V20H2Z" fill="#12141D"/>
        </svg>
        <span>My Designs</span>
      </button>
      <button class="tab-link" data-tab="order">
        <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path opacity="0.5" d="M1.9998 18V5.1L0.0498047 0.85L1.8498 0L4.1998 5.05H15.7998L18.1498 0L19.9498 0.85L17.9998 5.1V18H1.9998ZM7.9998 11H11.9998C12.2831 11 12.5206 10.9042 12.7123 10.7125C12.904 10.5208 12.9998 10.2833 12.9998 10C12.9998 9.71667 12.904 9.47917 12.7123 9.2875C12.5206 9.09583 12.2831 9 11.9998 9H7.9998C7.71647 9 7.47897 9.09583 7.2873 9.2875C7.09564 9.47917 6.9998 9.71667 6.9998 10C6.9998 10.2833 7.09564 10.5208 7.2873 10.7125C7.47897 10.9042 7.71647 11 7.9998 11ZM3.9998 16H15.9998V7.05H3.9998V16Z" fill="#12141D"/>
        </svg>

        <span>My Orders</span>
      </button>
    </div>

    <div class="main-tab-content">
      <div id="ai" class="tab-panel active">
        <h3 style="margin-bottom: 9px;">Text Prompt</h3>
        <div class="inner_tab_con">
          <div class="propmt">
              <div class="btn_ai_group">
                <button class="btn_main_top" type="button">Try an example</button>
                <button class="btn_main_top sec_btn" type="button">Enhance my prompt</button>
              </div>
              <textarea id="ai-prompt" class="search_prompt" maxlength="1000" placeholder="Type your idea, get your design! e.g. Space cat surfing a pizza galaxy" maxlength="1000" rows="4"  oninput="countChars('ai-prompt', 'tshirt-count')" ></textarea>
              <div id="tshirt-count" class="word_count_t">(0/1000)</div>
            <div id="generated-image" class="ai-image-wrap"></div>
          </div>
          <div class="btn_margin text-center">
              <button class="generate-btn" id="AiGenButton">Generate</button>  
            </div>
          
        </div>
      </div>

      <div id="upload" class="tab-panel">
        <h3>Upload Image</h3>
        <div class="upload-main main_text_custom">
          <p>Upload your own design or image to create your custom T-shirt. Make sure it’s high quality and follows our size and format guidelines.</p>
          <ul class="list-point">
            <li>Upload button (Upload Image)</li>
            <li>Supported formats: PNG, JPG (max 10MB)</li>
            <li>Optional crop/edit preview</li>
          </ul>
          <div class="main_new_cst">
            <div class="upload_box">
              <img src="{{ 'upload_box.svg' | asset_url }}" alt="upload_icon" accept="image/*" width="44" height="44"/> 
              <p>Upload Your Artwork</p>
            </div>
            <input type="file" class="fileUpload_cst" id="uploadImage" style="opacity: 0;" />
          </div>
        </div>
      </div>

      <div id="text" class="tab-panel">
        <h3>Add Text to Your Design</h3>
        <div class="main_text_custom">
          <p>Customize your design with a quote, name, or any message. Play with fonts, colors, and placement to match your vibe.</p>
          <div class="main_input">
            <input type="text" id="text-input" class="form_control" placeholder="Your text">
          </div>
         <div class="font-wrapper" style="margin-top: 15px; font-family: sans-serif; overflow-y: scroll; height: 300px;">
            <strong style="display:block; margin-bottom: 10px;">Fonts</strong>
            <div id="fontList"></div>
        </div>
            <div class="addons">
              <button id="bold-btn" onclick="toggleStyle('bold', this)"><b>B</b></button>
              <button id="italic-btn" onclick="toggleStyle('italic', this)"><i>I</i></button>
              <button id="underline-btn" onclick="toggleStyle('underline', this)"><u>U</u></button>


              <input type="color" id="font-color" value="#000000" onchange="changeFontColor(this.value)" />
            </div>

          <div class="group_btn">
            <button type="button" class="generate-btn" onclick="addTextToCanvas()">Apply Text</button>
          </div>
        </div>
      </div>

      <div id="design" class="tab-panel">
        <h3>My Designs</h3>
        <div class="main_text_custom">
          <button id="clearBtn" style="display:none;">Clear</button>
          <p>View and manage all the designs you've created or uploaded. You can edit, duplicate, or delete any of them.</p>
          <div class="design-list" id="myDesigns"></div>
        </div>
      </div>

       <div id="order" class="tab-panel">
            <h3>My Orders</h3>
            <div class="main_text_custom">
              {% if customer %}
                <p>Track all your orders here</p>
          
                <div class="order-tabs">
                  <button class="tab-button active" onclick="showTab('active-orders')">Active</button>
                  <button class="tab-button" onclick="showTab('completed-orders')">Completed</button>
                  <button class="tab-button" onclick="showTab('cancelled-orders')">Cancelled</button>
                </div>
          
                <div id="active-orders" class="order-tab-content">
                  {% assign found = false %}
                  {% for order in customer.orders %}
                    {% if order.cancelled_at == nil and order.fulfillment_status != 'fulfilled' %}
                      {% assign found = true %}
                      <div class="order">
                        <!-- <h4>Order #{{ order.name }} — {{ order.created_at | date: "%B %d, %Y" }}</h4> -->
                        <div class="main-order-cst">
                          {% for item in order.line_items %}
                            <div class="order_inner-wrap">
                              <img src="{{ item.image | img_url: 'small' }}" width="100%" height="auto" alt="{{ item.title }}">
                              <div class="order-details">
                                <p><strong>{{ item.title }}</strong></p>
                                {% if item.variant_title != 'Default Title' %}
                                  <p>Variant: {{ item.variant_title }}</p>
                                {% endif %}
                                <p>Price: {{ item.price | money }}</p>
                              </div>
                            </div>
                          {% endfor %}
                        </div>
                        <hr>
                      </div>
                    {% endif %}
                  {% endfor %}
                  {% unless found %}
                    <p>No active orders.</p>
                  {% endunless %}
                </div>
          
                <div id="completed-orders" class="order-tab-content" style="display:none;">
                  {% assign found = false %}
                  {% for order in customer.orders %}
                    {% if order.fulfillment_status == 'fulfilled' and order.cancelled_at == nil %}
                      {% assign found = true %}
                      <div class="order">
                        <!-- <h4>Order #{{ order.name }} — {{ order.created_at | date: "%B %d, %Y" }}</h4> -->
                        <div class="main-order-cst">
                          {% for item in order.line_items %}
                            <div class="order_inner-wrap">
                              <img src="{{ item.image | img_url: 'small' }}" width="100%" height="auto" alt="{{ item.title }}">
                              <div class="order-details">
                                <p><strong>{{ item.title }}</strong></p>
                                {% if item.variant_title != 'Default Title' %}
                                  <p>Variant: {{ item.variant_title }}</p>
                                {% endif %}
                                <p>Price: {{ item.price | money }}</p>
                              </div>
                            </div>
                          {% endfor %}
                          </div>
                        <hr>
                      </div>
                    {% endif %}
                  {% endfor %}
                  {% unless found %}
                    <p>No completed orders.</p>
                  {% endunless %}
                </div>
          
                <div id="cancelled-orders" class="order-tab-content" style="display:none;">
                  {% assign found = false %}
                  {% for order in customer.orders %}
                    {% if order.cancelled_at != nil %}
                      {% assign found = true %}
                      <div class="order">
                        <!-- <h4>Order #{{ order.name }} — {{ order.created_at | date: "%B %d, %Y" }}</h4> -->
                        <div class="main-order-cst">
                          {% for item in order.line_items %}
                            <div class="order_inner-wrap">
                              <img src="{{ item.image | img_url: 'small' }}" width="100%" height="auto" alt="{{ item.title }}">
                              <div class="order-details">
                                <p><strong>{{ item.title }}</strong></p>
                                {% if item.variant_title != 'Default Title' %}
                                  <p>Variant: {{ item.variant_title }}</p>
                                {% endif %}
                                <p>Price: {{ item.price | money }}</p>
                              </div>
                            </div>
                          {% endfor %}
                        </div>
                        <hr>
                      </div>
                    {% endif %}
                  {% endfor %}
                  {% unless found %}
                    <p>No cancelled orders.</p>
                  {% endunless %}
                </div>
              {% else %}
                <p>Please log in to view your orders.</p>
              {% endif %}
            </div>
          </div>

      
    </div>
  <div class="content">
    <div class="controls">
      <button onclick="showFront()" class="active btn_control">Front</button>
      <button onclick="showBack()" class="btn_control">Back</button>
    </div>

      <div id="tshirt-container">
        <!-- <img id="tshirt-image" src="{{ 'tshrit-front.png' | asset_url }}" alt="T-shirt Front" width="100%" height="auto" /> -->
        <!-- <canvas id="tshirt-canvas" width="200" height="200"></canvas> -->
         <canvas id="tshirt-canvas" width="500" height="500"></canvas>
      </div>
    <div class="footer-actions">
      <button class="btn-black-tshirt" onclick="addToCart()">Continue</button>
    </div>

    <!-- Toolbar -->  
    <div id="canvas-toolbar" class="cst_toolbar" >
      <button id="zoomInBtn" title="Zoom In">
        <img src="{{ 'zoom-in.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="zoomOutBtn" title="Zoom Out">
        <img src="{{ 'zoom-out.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="rotateLeftBtn" title="Rotate Left">
        <img src="{{ 'rotate-left.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="rotateRightBtn" title="Rotate Right">
        <img src="{{ 'rotate-right.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="dragBtn" title="Drag">
        <img src="{{ 'drag.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="undoBtn" title="Undo">
        <img src="{{ 'undo.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="redoBtn" title="Redo">
        <img src="{{ 'redo.svg' | asset_url }}" alt="" width="20" height="20">
      </button>
      <button id="deleteBtn" title="Delete" style="display: none;">
        <img src="{{ 'delete.svg' | asset_url }}" alt="Delete" width="20" height="20">
    </button>

    </div>

  </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js" defer></script>
